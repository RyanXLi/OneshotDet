MODEL:
  META_ARCHITECTURE: "GeneralizedRCNN"
  WEIGHT: "training_dir/fsfcos_0918_close/model_0040000.pth"
  RPN_ONLY: False
  FCOS_ON: True
  BACKBONE:
    CONV_BODY: "R-50-FPN-RETINANET"
  RESNETS:
    BACKBONE_OUT_CHANNELS: 256
  RETINANET:
    USE_C5: False # FCOS uses P5 instead of C5
  FCOS:
    CENTER_SAMPLE: True
    POS_RADIUS: 1.5
    LOC_LOSS_TYPE: "giou"
    NUM_CLASSES: 2
  RPN:
    USE_FPN: True
    # ANCHOR_STRIDE: (4, 8, 16, 32, 64)
    PRE_NMS_TOP_N_TRAIN: 12000
    PRE_NMS_TOP_N_TEST: 6000
    POST_NMS_TOP_N_TRAIN: 4000
    POST_NMS_TOP_N_TEST: 2000
    FPN_POST_NMS_TOP_N_TRAIN: 4000
    FPN_POST_NMS_TOP_N_TEST: 2000
    NMS_THRESH: 0.8
  ROI_HEADS:
    USE_FPN: True
  ROI_BOX_HEAD:
    POOLER_RESOLUTION: 7
    POOLER_SCALES: (0.125, 0.0625, 0.03125, 0.015625, 0.0078125)
    POOLER_SAMPLING_RATIO: 2
    FEATURE_EXTRACTOR: "FPN2ROIFeatureExtractor"
    PREDICTOR: "FPNPredictor"
    NUM_CLASSES: 2
DATASETS:
  TRAIN: ("coco_2017_train", ) # ("voc_2012_val_cocostyle",) 
  TEST:  ("voc_2007_test_cocostyle",) # ("coco_2017_val", )("voc_2012_val_cocostyle",)
INPUT:
  MIN_SIZE_TRAIN: (800,)
  SUPP_MIN_SIZE_TRAIN: (200,)
  MAX_SIZE_TRAIN: 1200
  SUPP_MAX_SIZE_TRAIN: 400
  MIN_SIZE_TEST: 800
  SUPP_MIN_SIZE_TEST: 200
  MAX_SIZE_TEST: 1200
  SUPP_MAX_SIZE_TEST: 400
DATALOADER:
  SIZE_DIVISIBILITY: 32
SOLVER:
  BASE_LR: 0.0005
  WEIGHT_DECAY: 0.0001
  STEPS: (60000, 90000, 120000)
  MAX_ITER: 130000
  IMS_PER_BATCH: 8
  WARMUP_METHOD: "constant"
  WARMUP_ITERS: 100
  CHECKPOINT_PERIOD: 1000
FEW_SHOT:
  NEG_SUPPORT:
    TURN_ON: False
  CHOOSE_CLOSE: True 
  SUPP_ROIALIGN: True
  SUPP_AUG: False
  SUPP_AUG_METHOD: 'conv'
  ADD_ARTIFICIAL_PROPOSALS: False
  NUM_SHOT: 1
  SECOND_STAGE_METHOD: 'concat'
  POOLING: 'ROI'
  LOAD_PRETRIANED_RPN_ONLY: False
  SIAMESE_BACKBONE: True
  #UNLOAD_KEYWORD : ('roi_heads',)
  #UNTRAINED_KEYWORD:  ('rpn','backbone')
  RESUME: False
LOSS:
  CLS_LOSS: 'BINARY'
  FOCAL_LOSS: 'SIGMOID'